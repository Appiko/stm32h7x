/*
 *  imx290.c : <Write brief>
 *  Copyright (C) 2019  Appiko
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */
#include "imx290.h"
#include "stm32f7xx_hal.h"

extern I2C_HandleTypeDef hi2c1;
CAMERA_DrvTypeDef imx290_drv = 
{
  imx290_Init,
  imx290_ReadID,  
  imx290_Config,
};

typedef struct
{
    uint16_t addr;
    uint8_t val;
}imx290_regval_t;

static const imx290_regval_t imx290_global_init_settings[] = {
	{ 0x3007, 0x00 },
	{ 0x3009, 0x00 },
	{ 0x3018, 0x65 },
	{ 0x3019, 0x04 },
	{ 0x301a, 0x00 },
	{ 0x3443, 0x03 },
	{ 0x3444, 0x20 },
	{ 0x3445, 0x25 },
	{ 0x3407, 0x03 },
	{ 0x303a, 0x0c },
	{ 0x3040, 0x00 },
	{ 0x3041, 0x00 },
	{ 0x303c, 0x00 },
	{ 0x303d, 0x00 },
	{ 0x3042, 0x9c },
	{ 0x3043, 0x07 },
	{ 0x303e, 0x49 },
	{ 0x303f, 0x04 },
	{ 0x304b, 0x0a },
	{ 0x300f, 0x00 },
	{ 0x3010, 0x21 },
	{ 0x3012, 0x64 },
	{ 0x3016, 0x09 },
	{ 0x3070, 0x02 },
	{ 0x3071, 0x11 },
	{ 0x309b, 0x10 },
	{ 0x309c, 0x22 },
	{ 0x30a2, 0x02 },
	{ 0x30a6, 0x20 },
	{ 0x30a8, 0x20 },
	{ 0x30aa, 0x20 },
	{ 0x30ac, 0x20 },
	{ 0x30b0, 0x43 },
	{ 0x3119, 0x9e },
	{ 0x311c, 0x1e },
	{ 0x311e, 0x08 },
	{ 0x3128, 0x05 },
	{ 0x313d, 0x83 },
	{ 0x3150, 0x03 },
	{ 0x317e, 0x00 },
	{ 0x32b8, 0x50 },
	{ 0x32b9, 0x10 },
	{ 0x32ba, 0x00 },
	{ 0x32bb, 0x04 },
	{ 0x32c8, 0x50 },
	{ 0x32c9, 0x10 },
	{ 0x32ca, 0x00 },
	{ 0x32cb, 0x04 },
	{ 0x332c, 0xd3 },
	{ 0x332d, 0x10 },
	{ 0x332e, 0x0d },
	{ 0x3358, 0x06 },
	{ 0x3359, 0xe1 },
	{ 0x335a, 0x11 },
	{ 0x3360, 0x1e },
	{ 0x3361, 0x61 },
	{ 0x3362, 0x10 },
	{ 0x33b0, 0x50 },
	{ 0x33b2, 0x1a },
	{ 0x33b3, 0x04 },
};

static const imx290_regval_t imx290_1080p_settings[] = {
	/* mode settings */
	{ 0x3007, 0x00 },
	{ 0x303a, 0x0c },
	{ 0x3414, 0x0a },
	{ 0x3472, 0x80 },
	{ 0x3473, 0x07 },
	{ 0x3418, 0x38 },
	{ 0x3419, 0x04 },
	{ 0x3012, 0x64 },
	{ 0x3013, 0x00 },
	{ 0x305c, 0x18 },
	{ 0x305d, 0x03 },
	{ 0x305e, 0x20 },
	{ 0x305f, 0x01 },
	{ 0x315e, 0x1a },
	{ 0x3164, 0x1a },
	{ 0x3480, 0x49 },
	/* data rate settings */
	{ 0x3009, 0x01 },
	{ 0x3405, 0x10 },
	{ 0x3446, 0x57 },
	{ 0x3447, 0x00 },
	{ 0x3448, 0x37 },
	{ 0x3449, 0x00 },
	{ 0x344a, 0x1f },
	{ 0x344b, 0x00 },
	{ 0x344c, 0x1f },
	{ 0x344d, 0x00 },
	{ 0x344e, 0x1f },
	{ 0x344f, 0x00 },
	{ 0x3450, 0x77 },
	{ 0x3451, 0x00 },
	{ 0x3452, 0x1f },
	{ 0x3453, 0x00 },
	{ 0x3454, 0x17 },
	{ 0x3455, 0x00 },
	{ 0x301c, 0x98 },
	{ 0x301d, 0x08 },
};

static const imx290_regval_t imx290_720p_settings[] = {
	/* mode settings */
	{ 0x3007, 0x10 },
	{ 0x303a, 0x06 },
	{ 0x3414, 0x04 },
	{ 0x3472, 0x00 },
	{ 0x3473, 0x05 },
	{ 0x3418, 0xd0 },
	{ 0x3419, 0x02 },
	{ 0x3012, 0x64 },
	{ 0x3013, 0x00 },
	{ 0x305c, 0x20 },
	{ 0x305d, 0x00 },
	{ 0x305e, 0x20 },
	{ 0x305f, 0x01 },
	{ 0x315e, 0x1a },
	{ 0x3164, 0x1a },
	{ 0x3480, 0x49 },
	/* data rate settings */
	{ 0x3009, 0x01 },
	{ 0x3405, 0x10 },
	{ 0x3446, 0x4f },
	{ 0x3447, 0x00 },
	{ 0x3448, 0x2f },
	{ 0x3449, 0x00 },
	{ 0x344a, 0x17 },
	{ 0x344b, 0x00 },
	{ 0x344c, 0x17 },
	{ 0x344d, 0x00 },
	{ 0x344e, 0x17 },
	{ 0x344f, 0x00 },
	{ 0x3450, 0x57 },
	{ 0x3451, 0x00 },
	{ 0x3452, 0x17 },
	{ 0x3453, 0x00 },
	{ 0x3454, 0x17 },
	{ 0x3455, 0x00 },
	{ 0x301c, 0xe4 },
	{ 0x301d, 0x0c },
};

static const imx290_regval_t imx290_10bit_settings[] = {
	{ 0x3005, 0x00},
	{ 0x3046, 0x00},
	{ 0x3129, 0x1d},
	{ 0x317c, 0x12},
	{ 0x31ec, 0x37},
	{ 0x3441, 0x0a},
	{ 0x3442, 0x0a},
	{ 0x300a, 0x3c},
	{ 0x300b, 0x00},
};

static const imx290_regval_t imx290_arducam_settings[] = {
    {0x3003, 0x01},
    {0x3000, 0x01},
    {0x3002, 0x01},
    {0x300f, 0x00},
    {0x3010, 0x21},
    {0x3012, 0x64},
    {0x3016, 0x09},
    {0x3070, 0x02},
    {0x3071, 0x11},
    {0x309b, 0x10},
    {0x309c, 0x22},
    {0x30a2, 0x02},
    {0x30a6, 0x20},
    {0x30a8, 0x20},
    {0x30aa, 0x20},
    {0x30ac, 0x20},
    {0x30b0, 0x43},
    {0x305c, 0x18},
    {0x305d, 0x00},
    {0x305e, 0x20},
    {0x305f, 0x01},
    {0x3119, 0x9e},
    {0x311c, 0x1e},
    {0x311e, 0x08},
    {0x3128, 0x05},
    {0x313d, 0x83},
    {0x3150, 0x03},
    {0x317e, 0x00},
    {0x315e, 0x1a},
    {0x3164, 0x1a},
    {0x32b8, 0x50},
    {0x32b9, 0x10},
    {0x32ba, 0x00},
    {0x32bb, 0x04},
    {0x32c8, 0x50},
    {0x32c9, 0x10},
    {0x32ca, 0x00},
    {0x32cb, 0x04},
    {0x332c, 0xd3},
    {0x332d, 0x10},
    {0x332e, 0x0d},
    {0x3358, 0x06},
    {0x3359, 0xe1},
    {0x335a, 0x11},
    {0x3360, 0x1e},
    {0x3361, 0x61},
    {0x3362, 0x10},
    {0x33b0, 0x50},
    {0x33b2, 0x1a},
    {0x33b3, 0x04},
    {0x3480, 0x49},
    {0x3005, 0x01},
    {0x3007, 0x00},
    {0x3009, 0x02},
    {0x3018, 0x65},
    {0x3019, 0x04},
    {0x301c, 0x30},
    {0x301d, 0x12},
    {0x3046, 0x01},
    {0x3048, 0x02},
    {0x3049, 0x03},
    {0x3129, 0x00},
    {0x317c, 0x00},
    {0x31ec, 0x00},
    {0x3000, 0x00},
    {0x3002, 0x00},
    {0x304a, 0xc0},
    {0x304b, 0x0a},
    {0x301c, 0x30},
    {0x301d, 0x16},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3021, 0x02},
    {0x3020, 0x92},
    {0x3014, 0x51},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x32},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x3b},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x40},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x42},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x48},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x4d},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x51},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x56},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x5a},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x5b},
    {0x3021, 0x02},
    {0x3020, 0x34},
    {0x3019, 0x04},
    {0x3018, 0x65},
    {0x3014, 0x5d}
//    {0x3021, 0x02},
//    {0x3020, 0x34},
//    {0x3019, 0x04},
//    {0x3018, 0x65},
//    {0x3014, 0x5d},
//    {0x3021, 0x02},
//    {0x3020, 0x34},
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
//    {0x3021, 0x02
//    {0x3020, 0x34
//    {0x3019, 0x04
//    {0x3018, 0x65
//    {0x3014, 0x5d
};

void imx290_Init(uint16_t DeviceAddr, uint32_t resolution)
{
    uint32_t index;
    /* Initialize I2C */
    CAMERA_IO_Init();   

//    for(index = 0; index < (sizeof(imx290_global_init_settings)/sizeof(imx290_regval_t)); index++)
//    {
//        CAMERA_IO_Write (DeviceAddr, imx290_global_init_settings[index].addr, imx290_global_init_settings[index].val);
//        CAMERA_Delay (2);
//    }
//    for(index = 0; index < (sizeof(imx290_10bit_settings)/sizeof(imx290_regval_t)); index++)
//    {
//        CAMERA_IO_Write (DeviceAddr, imx290_10bit_settings[index].addr, imx290_10bit_settings[index].val);
//        CAMERA_Delay (2);
//    }
    
  
    switch(resolution)
    {
        case CAMERA_R320x240 :
            break;
        case CAMERA_RAW : 
//            for(index=0; index<(sizeof(imx290_1080p_settings)/sizeof(imx290_regval_t)); index++)
//            {
//              CAMERA_IO_Write(DeviceAddr, imx290_1080p_settings[index].addr, imx290_1080p_settings[index].val);
//              CAMERA_Delay(2);
//            } 
            for(index=0; index<(sizeof(imx290_arducam_settings)/sizeof(imx290_regval_t)); index++)
            {
              CAMERA_IO_Write(DeviceAddr, imx290_arducam_settings[index].addr, imx290_arducam_settings[index].val);
              CAMERA_Delay(2);
            } 
            
            break;
        break;
    }
//    CAMERA_IO_Write (DeviceAddr, IMX290_STANDBY, 0x00);
//    CAMERA_Delay (30);
//    CAMERA_IO_Write (DeviceAddr, IMX290_XMSTA, 0x00);
}
void imx290_Config(uint16_t DeviceAddr, uint32_t reg, uint32_t value, uint32_t Unused)
{
    CAMERA_IO_Write (DeviceAddr, reg, value);
    __NOP();
    __NOP();
    __NOP();
    __NOP();
    __NOP();
    __NOP();
    __NOP();
    __NOP();
    __NOP();
    __NOP();
}
uint16_t imx290_ReadID(uint16_t DeviceAddr)
{
  /* Initialize I2C */
  CAMERA_IO_Init();
//  HAL_I2C_Init (&hi2c1);
  
  /* Get the camera ID */
  return 0;
}
